/*!
 * World JS: History Simulation
 * Version 3.0.0
 *
 * https://github.com/anvoz/world-js
 * Copyright (c) 2013-2014 An Vo - anvo4888@gmail.com
 * Code released under MIT (http://www.opensource.org/licenses/mit-license.php)
 * Knowledge data and language released under Creative Commons (http://creativecommons.org/licenses/by-nc/4.0/deed.en_US)
 */
!function(a,b){"use strict";var c=a.document,d=function(){return a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(b){a.setTimeout(function(){b(+new Date)},1e3/60)}}(),e=a.WorldJS=function(){var a=this;a.running=!1,a.stopCallback=function(){},a.width=640,a.height=360,a.padding=10,a.canvas={wrapper:!1,context:!1},a.sprite={src:"images/icons.png",image:!1},a.displayMode="full",a.totalSeeds=0,a.nextSeedId=1,a.maxSafeSeedsForDisplay=3e4,a.tickPerYear=60,a.speed=1,a.tickMod=0,a.distributedTicks=[];for(var b=0;b<a.tickPerYear-1;b++)a.distributedTicks.push(0);a.lastTickTime=0,a.fps=0,a.tile=new e.Tile(a),a.event=new e.Event(a)};e.prototype.init=function(a){var b=this,d=c.createElement("canvas"),e=c.getElementById(a),f=e.clientWidth||b.width,g=e.clientHeight||b.height;b.canvas.wrapper=e,b.width=d.width=f,b.height=d.height=g,e.appendChild(d),b.canvas.context=d.getContext("2d");var h=new Image;return h.src=b.sprite.src,b.sprite.image=h,b.tile.init(f,g),b},e.prototype.addSeed=function(a,c){c=c||{};var d=this,e=new a(c);d.totalSeeds++,e.world=d,e.id=d.nextSeedId++,e.age=c.age||0,e.tickCount=e.age>0?e.age*d.tickPerYear:e.tickCount;var f=d.getTickIndex();d.distributedTicks[f]++,e.tickIndex=f,e.tickMod=d.tickMod,e.tickCount+=(d.tickMod+e.tickCount+e.tickIndex)%e.actionInterval,e.stepCount=e.tickCount,e.moveUntilStep=e.moveUntilStep||e.tickCount+d.random(2,10)*e.jumpInterval;var g=d.getRandomPosition(e);return e.x=g.x,e.y=g.y,e.tileIndex=d.tile.getIndex(e),d.tile.set(e),d.event.trigger("seedAdded",{seed:e,mother:c.mother||b}),e},e.prototype.getTickIndex=function(){for(var a=this,b=a.distributedTicks,c=0,d=b[c],e=0,f=b.length;f>e;e++)b[e]<d&&(c=e,d=b[e]);return c},e.prototype.getRandomPosition=function(a,b){b=b||!1;var c=this,d=a.x===!1||b?c.random(c.padding,c.width-a.icon.width-c.padding):a.x,e=a.y===!1||b?c.random(c.padding,c.height-a.icon.height-c.padding):a.y;return{x:d,y:e}},e.prototype.removeSeed=function(a){var b=this;return b.totalSeeds--,b.event.trigger("seedRemoved",{seed:a}),a.relationSeed!==!1&&(a.relationSeed.relationSeed=!1,a.relationSeed=!1),b.tile.rem(a),b.distributedTicks[a.tickIndex]--,b},e.prototype.addSeeds=function(a,b){b=b||{};for(var c=this,d="undefined"!=typeof b.types?b.types:[c.Seed],e="undefined"!=typeof b.minAge?b.minAge:15,f="undefined"!=typeof b.maxAge?b.maxAge:20,g=0;a>g;g++){var h=c.random(e,f),i={x:!1,y:!1,age:h};if("undefined"!=typeof b.fromBorder){var j=["top","bottom","left","right"],k="random"===b.fromBorder?j[c.random(0,3)]:b.fromBorder;switch(k){case"top":i.y=c.random(0,c.padding);break;case"bottom":i.y=c.random(c.height-c.padding-1,c.height-1);break;case"left":i.x=c.random(0,c.padding);break;case"right":i.x=c.random(c.width-c.padding-1,c.width-1)}}c.addSeed(d[g%d.length],i)}return c},e.prototype.run=function(a){var b=this,c=b.canvas.context,e=b.sprite.image;b.tickMod=++b.tickMod%b.tickPerYear;var f=0===b.tickMod,g=b.totalSeeds<=b.maxSafeSeedsForDisplay||f;g&&c.clearRect(0,0,b.width,b.height);for(var h=b.tile.list,i=b.tile.maxDisplayedSeeds,j=b.speed,k=0,l=h.length;l>k;k++)for(var m=h[k],n=0,o=0,p=m.length;p>o;o++)if(m[o]){var q=m[o],r=q.tileIndex;if(q.tickMod==b.tickMod)continue;if(q.tickMod=b.tickMod,f&&q.age++,g&&i>n){switch(b.displayMode){case"full":q.draw(c,e);break;case"dot":q.draw(c,!1);break;case"none":}n++}q.tick(j);var s=b.tile.getIndex(q);s!==r&&(b.tile.rem(q),q.tileIndex=s,b.tile.set(q))}return f&&(b.event.trigger("yearPassed"),0===b.totalSeeds)?void(b.running=!1):(b.running?(b.fps=1e3/(a-b.lastTickTime),b.lastTickTime=a,d(function(){b.run.call(b)})):(b.stopCallback.call(b),b.stopCallback=function(){}),b)},e.prototype.start=function(){var a=this;return a.running=!0,a.run(),a},e.prototype.stop=function(a){var b=this;return b.running=!1,"function"==typeof a&&(b.stopCallback=a),b},e.prototype.random=function(a,b){return Math.floor(Math.random()*(b-a+1)+a)}}(window),function(a){"use strict";var b,c=a.WorldJS;b=c.Tile=function(a){var b=this;b.world=a,b.list=[],b.availableArrayIndexes=[],b.size=20,b.maxDisplayedSeeds=7,b.totalTiles=!1,b.tilesPerRow=!1,b.tilesPerCol=!1},b.prototype.init=function(a,b){var c=this,d=c.size,e=Math.ceil(b/d),f=Math.ceil(a/d),g=e*f;c.tilesPerRow=e,c.tilesPerCol=f,c.totalTiles=g;for(var h=c.list,i=c.availableArrayIndexes,j=0;g>j;j++)h.push([]),i.push([])},b.prototype.getIndex=function(a){var b=this.size,c=Math.floor(a.x/b),d=Math.floor(a.y/b);return c+d*this.tilesPerCol},b.prototype.set=function(a){var b=this,c=a.tileIndex,d=b.list[c],e=b.availableArrayIndexes[c];e.length>0?(a.tileArrayIndex=e.pop(),d[a.tileArrayIndex]=a):(a.tileArrayIndex=d.length,d.push(a))},b.prototype.rem=function(a){var b=this,c=a.tileIndex,d=a.tileArrayIndex;b.list[c][d]=!1,b.availableArrayIndexes[c].push(d)}}(window),function(a){"use strict";var b,c=a.WorldJS;b=c.Event=function(a){var b=this;b.world=a,b.list={yearPassed:{},seedAdded:{},seedRemoved:{}}},b.prototype.add=function(a,b,c){this.list[a][b]=c},b.prototype.remove=function(a,b){delete this.list[a][b]},b.prototype.trigger=function(a,b){var c=this,d=c.world,e=c.list[a];for(var f in e)e.hasOwnProperty(f)&&e[f].call(d,b)}}(window),function(a){"use strict";var b,c=a.WorldJS;b=c.prototype.Seed=function(a){var b=this;b.world=!1,b.id=!1,b.tileIndex=!1,b.tickIndex=!1,b.tickMod=!1,b.age=a.age||0,b.x="undefined"==typeof a.x?!1:a.x,b.y="undefined"==typeof a.y?!1:a.y,b.icon=a.icon||{width:1,height:1},b.carrying=a.carrying||!1,b.relationSeed=a.relationSeed||!1,b.tickCount=a.tickCount||0,b.actionInterval=a.actionInterval||30,b.stepCount=b.tickCount,b.jumpInterval=20,b.moveUntilStep=a.moveUntilStep||0,b.ageToMoveAgain=0,b.isMoving=!1,b.moveTo=a.moveTo||!1},b.prototype.draw=function(a,b){var c=this;if(b===!1||1===c.icon.width){var d=b!==!1?c.icon.width:1,e=b!==!1?c.icon.height:1;a.fillRect(c.x,c.y,d,e)}else{var f=c.age<=c.maxChildAge?c.icon.child:c.icon,g=c.jumpInterval,h=10,i=c.stepCount%g,j=h>i?i+1:h-i%h-1;if(a.drawImage(b,f.x,f.y,f.width,f.height,c.x,c.y-j,f.width,f.height),c.carrying!==!1&&"none"!==c.carrying){var k=c.carrying;a.drawImage(b,k.x,k.y,k.width,k.height,c.x+k.dx,c.y-j+k.dy,k.width,k.height)}}},b.prototype.getCarryingItem=function(a,b){var c=this,d=c.world;if("undefined"!=typeof d.items){var e=d.items,f=[];for(var g in e){var h=e[g];h.enabled===!0&&h.who===a&&h.when===b&&f.push(h.icon)}var i=f.length;if(1===i)return f[0];if(i>1)return f[d.random(0,i-1)]}return!1},b.prototype.move=function(a,b){var c=this,d=c.world,e=d.random;if(c.isMoving=!0,b)b.call(c);else if(c.stepCount>=c.moveUntilStep){if(0===c.ageToMoveAgain||c.ageToMoveAgain>c.age)return 0===c.ageToMoveAgain&&(c.ageToMoveAgain=c.age+e(2,c.age),c.carrying=!1),void(c.isMoving=!1);c.ageToMoveAgain=0,c.moveUntilStep=c.stepCount+e(2,10)*c.jumpInterval,c.carrying=!1}(c.moveTo===!1||c.moveTo.x===c.x&&c.moveTo.y===c.y)&&(c.moveTo=d.getRandomPosition(c,!0)),c.stepCount++,c.x<c.moveTo.x?c.x=Math.min(c.x+a,c.moveTo.x):c.x>c.moveTo.x&&(c.x=Math.max(c.x-a,0)),c.y<c.moveTo.y?c.y=Math.min(c.y+a,c.moveTo.y):c.y>c.moveTo.y&&(c.y=Math.max(c.y-a,0))},b.prototype.seek=function(a){var b=this,c=b.world.tile,d=[[0,0],[-1,0],[1,0],[0,-1],[0,1],[-1,-1],[-1,1],[1,-1],[1,1]];a||(a=function(a){return a.id!=b.id});for(var e=c.tilesPerRow,f=c.tilesPerCol,g=0,h=d.length;h>g;g++){var i;if(0===g)i=b.tileIndex;else{var j=b.tileIndex%e+d[g][0],k=Math.floor(b.tileIndex/e)+d[g][1];if(!(j>=0&&e>j&&k>=0&&f>k))continue;i=j+k*e}for(var l=c.list[i],m=0,n=l.length;n>m;m++)if(l[m]&&b.id!=l[m].id){var o=l[m];if(a.call(b,o))return o}}return!1},b.prototype.tick=function(a){var b=this;b.tickCount++,b.move(a)},b.prototype.getChance=function(a){for(var b=this,c=b.chances[a],d=b.age,e=0,f=0,g=0,h=0;c[e]&&d>=c[e].range[0];){var i=c[e];f=i.range[0],g=i.from,h=(i.to-i.from)/(i.range[1]-i.range[0]),e++}return g+(d-f)*h}}(window),function(a){"use strict";var b,c=a.WorldJS,d=c.prototype.Seed;b=c.prototype.Male=function(a){var b=this;a.icon={x:0,y:0,width:13,height:20,child:{x:26,y:0,width:11,height:10}},d.call(b,a),b.maxChildAge=15,b.chances=a.chances||{death:[{range:[1,20],from:.02,to:.01},{range:[20,60],from:.01,to:.02},{range:[60,80],from:.02,to:.05},{range:[80,100],from:.05,to:.9}],marriage:[{range:[15,30],from:.1,to:.5},{range:[30,50],from:.5,to:.1},{range:[50,80],from:.1,to:.01}]}},b.prototype=Object.create(d.prototype),b.prototype.contructor=b,b.prototype.tick=function(a){var b=this,c=b.world;b.tickCount++;var d=b.actionInterval/a;if(b.tickCount%d===d-1){var e=b.getChance("death");if(e>0&&Math.random()<e)return void c.removeSeed(b);if(b.relationSeed===!1&&b.age>=b.chances.marriage[0].range[0]){var f=b.getChance("marriage");if(f>0){var g=Math.random();if(f>g){var h=b.seek(function(a){var b=this,c=b.world;return a instanceof c.Female&&a.relationSeed===!1&&a.age>=a.chances.childbirth[0].range[0]&&(a.age<=b.age||g*Math.ceil((a.age-b.age)/10)<f)});h!==!1&&(b.relationSeed=h,h.relationSeed=b,"undefined"==typeof h.totalChildren&&(h.totalChildren=0),h.ageLastBear=h.age+1,b.carrying=!1,h.carrying=!1)}}}}if(b.relationSeed!==!1){if(b.x===Math.max(0,b.relationSeed.x-10)&&b.y===b.relationSeed.y)return;b.move(a,function(){var a=this,b=a.relationSeed;a.moveTo.x=Math.max(a.world.padding,b.x-10),a.moveTo.y=b.y})}else b.move(a,!1);if(b.carrying===!1&&"undefined"!=typeof c.items)if(Math.random()<.2){if(b.age>b.maxChildAge){var i=b.relationSeed===!1?"man":"husband",j=b.isMoving?"moving":"standing";b.carrying=b.getCarryingItem(i,j)}}else b.carrying="none"}}(window),function(a,b){"use strict";var c,d=a.WorldJS,e=d.prototype.Seed;c=d.prototype.Female=function(a){var c=this;a.icon={x:13,y:0,width:13,height:20,child:{x:26,y:10,width:11,height:10}},e.call(c,a),c.maxChildAge=15,c.totalChildren=b,c.ageLastBear=0,c.chances=a.chances||{death:[{range:[1,25],from:.02,to:.01},{range:[25,65],from:.01,to:.02},{range:[65,85],from:.02,to:.05},{range:[85,105],from:.05,to:.9}],childbirth:[{range:[15,25],from:.1,to:.25},{range:[25,50],from:.25,to:.1},{range:[50,70],from:.1,to:.001}]}},c.prototype=Object.create(e.prototype),c.prototype.contructor=c,c.prototype.tick=function(a){var b=this,c=b.world;b.tickCount++;var d=b.actionInterval/a;if(b.tickCount%d===d-1){var e=b.age,f=b.getChance("death");if(f>0&&Math.random()<f)return void c.removeSeed(b);if(b.relationSeed!==!1&&e>=b.chances.childbirth[0].range[0]&&e>b.ageLastBear){var g=b.getChance("childbirth");if(g>0&&Math.random()<g){b.ageLastBear=e+1,b.totalChildren++;var h={x:b.x,y:Math.min(c.height-1-c.padding,b.y+Math.floor(b.icon.height/2)),mother:b};Math.random()<.5?c.addSeed(c.Male,h):c.addSeed(c.Female,h)}}}if(b.move(a,!1),b.carrying===!1&&"undefined"!=typeof c.items)if(Math.random()<.2){if(b.age>b.maxChildAge){var i=b.relationSeed===!1?"woman":"wife",j=b.isMoving?"moving":"standing";b.carrying=b.getCarryingItem(i,j)}}else b.carrying="none"}}(window),function(a){"use strict";var b,c=a.WorldJS;b=c.Statistic=function(a){var b=this;b.world=a,b.year=0,b.population=0,b.men=0,b.women=0,b.boys=0,b.girls=0,b.families=0,b.maxAge=0,b.yearMaxAge=0,b.die=0,b.sumAge=0,b.avgChildren=0;var c=a.event;c.add("yearPassed","statistic",function(){this.statistic.yearPassed()}),c.add("seedRemoved","statistic",function(a){this.statistic.seedRemoved(a.seed)})},b.prototype.seedRemoved=function(a){var b=this;b.die++;var c=a.age;c>b.maxAge&&(b.maxAge=c,b.yearMaxAge=b.year),b.sumAge+=c},b.prototype.yearPassed=function(){for(var a=this,b=a.world,c=b.tile.list,d=0,e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=c.length;l>k;k++)for(var m=c[k],n=0,o=m.length;o>n;n++)if(m[n]){var p=m[n];d++,p instanceof b.Male?p.age<=p.maxChildAge?g++:(e++,p.relationSeed!==!1&&i++):p.age<=p.maxChildAge?h++:(f++,"undefined"!=typeof p.totalChildren&&(j+=p.totalChildren))}a.year++,a.population=d,a.men=e,a.women=f,a.boys=g,a.girls=h,a.families=i,a.avgChildren=Math.floor(j/f)||0}}(window),function(a){"use strict";var b,c=a.WorldJS;b=c.Rules=function(a){var b=this;b.world=a,b.population={limit:100},b.chance={death:0,marriage:0,childbirth:0},b.chanceIncr={death:0,marriage:0,childbirth:0},b.food={adult:1,child:-1,resourceIncr:0,min:-1e4},b.famine={deathChanceIncr:.1,unit:-100},b.foodSpoilage={foodDecr:.9,interval:1},b.largeCooperation={deathChanceIncr:.1,unit:1};var c=a.statistic;c.food=0,c.foodResource=500;var d=a.event;if(d.add("yearPassed","rules",function(){var a=this;a.rules.change()}),"undefined"==typeof a.Seed.prototype.getChanceInjected){a.Seed.prototype.getChanceInjected=function(){};var e=a.Seed.prototype.getChance;a.Seed.prototype.getChance=function(a){var b=this,c=b.world,d=c.rules,f=e.call(b,a);return"undefined"!=typeof d.chance[a]&&0!==d.chance[a]&&(f+=f*d.chance[a]),f}}},b.prototype.change=function(){var a=this,b=a.world,c=b.statistic,d=c.food,e=c.foodResource,f=c.population,g=c.men+c.women,h=c.boys+c.girls,i=Math.min(e,g*a.food.adult),j=h*a.food.child,k=i+j;e=Math.max(0,e-i),d+=k,d<a.food.min&&(d=a.food.min);var l=0,m=0;d<=a.famine.unit&&(m=Math.floor(d/a.famine.unit),l+=m*a.famine.deathChanceIncr),c.year%a.foodSpoilage.interval===0&&d>0&&(d-=Math.floor(d*a.foodSpoilage.foodDecr)),f>a.population.limit&&(m=f-a.population.limit,m=Math.floor(m/a.largeCooperation.unit),l+=m*a.largeCooperation.deathChanceIncr),c.food=d,c.foodResource=e,a.chance.death=l+a.chanceIncr.death}}(window),function(a){"use strict";var b,c=a.WorldJS;b=c.Knowledge=function(a){var b=this;b.world=a,b.list={},b.trending=[],b.trendingAdded=function(){},b.trendingRemoved=function(){},b.completed=[];var c=a.statistic;c.iq=0,c.maxIQ=0,c.yearMaxIQ=0;var d=a.rules;d.baseIQ=0;var e=a.event;e.add("seedAdded","knowledge",function(a){this.knowledge.seedAdded(a)}),e.add("seedRemoved","knowledge",function(a){this.knowledge.seedRemoved(a)}),e.add("yearPassed","knowledge",function(){this.knowledge.gain()})},b.prototype.seedAdded=function(a){var b=a.seed,c=b.world;"undefined"!=typeof a.mother&&(b.iq=Math.round((a.mother.relationSeed.iq+a.mother.iq)/2)),b.iq=b.iq||0,b.iq+=c.random(0,3),b.iq+=c.rules.baseIQ;var d=c.statistic;d.iq+=b.iq,b.iq>d.maxIQ&&(d.maxIQ=b.iq,d.yearMaxIQ=d.year)},b.prototype.seedRemoved=function(a){var b=a.seed,c=b.world;c.statistic.iq-=b.iq},b.prototype.gain=function(){var a=this,b=a.world,c=b.statistic.year,d=b.statistic.iq,e=[],f=0,g=!1,h=0,i=0;for(h=0,i=a.trending.length;i>=h;h++)e[h]=b.random(0,100),i>h&&(g=a.list[a.trending[h]],1!=g.iq.priority&&(e[h]*=g.iq.priority)),f+=e[h];var j={.1:.01,1:.05,2:.1},k=[],l=[],m=[];for(h=0,i=a.trending.length;i>h;h++){g=a.list[a.trending[h]];var n=d*e[h]/f,o=g.iq.gained;o+=Math.floor(Math.min(g.iq.required*j[g.iq.priority],n)),isNaN(o)&&(o=g.iq.gained),o>=g.iq.required?(g.iq.gained=g.iq.required,l.push.apply(l,g.following),g.affectedYear=c,"function"==typeof g.onAffected&&g.onAffected(b),m.push(g)):(g.iq.gained=o,k.push(g.id))}if(m.length>0){for(h=0;h<m.length;h++)a.trendingRemoved(m[h]),a.completed.push(m[h]);for(h=0;h<l.length;h++)a.trendingAdded(a.list[l[h]]),k.push(l[h]);a.trending=k}}}(window),function(a){"use strict";{var b=a.WorldJS;b.Language={introPhysicsQuote:"From nothing, our universe begins.",introPhysicsAuthor:"A Short History of Nearly Everything by Bill Bryson",introPhysics01:"About 13 billion years ago, matter comes into existence in what is known as the Big Bang.",introPhysics02:"In this first story of our universe - which is called Physics - space, time, matter, energy are formed and start interacting with one another.",introChemistryQuote:"It really is the most poetic thing I know about physics: You are all stardust.",introChemistryAuthor:"Lawrence M. Krauss",introChemistry01:"About 300,000 years after the Big Bang, matter comes into complex structures to form atoms. Then, atoms come together to form molecules.",introChemistry02:"The story of atoms, molecules, and their interactions is called Chemistry.",introBiologyQuote:"One of the deepest functions of living organisms is to look ahead, to produce future.",introBiologyAuthor:"Francois Jacob",introBiology01:"About 4 billion years ago, molecules combine to form even larger and more complex structures which are called organisms, or living creatures.",introBiology02:"The story of organisms, their functions and interactions is called Biology.",introHistoryQuote:"History is simply the next stage in the process of ongoing complexity in the universe.",introHistoryAuthor:"A Brief History of Humankind by Yuval Noah Harari",introHistory01:"About 70,000 years ago, organisms belonging to our species, Homo sapiens come together, combine and form even more elaborate structures, which are called cultures.",introHistory02:"The story of the formation, development and interaction of human cultures is called History.",introGame01:"World JS is an attempt to show you a brief history of humankind via a simulation game.",introGame02:"The game currently shows you history from about 250,000 to 10,000 years ago. It's still developing and I really need more contributors. Javascript developers, artists, writers and history lovers, please join this project.",introGame03:"For any feedback or ideas, please email me at anvo4888@gmail.com.",storyBegin01:"About 250,000 years ago, our ancestors begin their lives in East Africa.<br>They have extraordinary large brains and the ability of walking upright.",storyBegin02:"Therefore they are less muscular and born prematurely.<br>They need to evolve stronger social ties and start living in small bands.",storyEnd01:"Humans simply destroy everything that stands in their paths.<br>They drive to the extinction of most large species long before the invention of writing.",storyEnd02:"When the decline in the availability of wild foods becomes critical, humans can do better than<br>what you've just seen to survive by living in equilibrium with nature or self-producing food.",knowledgeHUGAName:"Hunting and gathering",knowledgeHUGAMessage:"They are foraging edible plants and animals from the wild.<br>This activity is occupying at least 90 percent of human history.",knowledgeHUGADescription01:"Live a hand-to-mouth existence by collecting food from the wild.",knowledgeFIREName:"Controlling of fire",knowledgeFIREMessage:"Controlling of fire is an important step in the evolution of our ancestors.<br>They gain new source of light, warmth and power to start changing their behaviors.",knowledgeFIREDescription01:"Provide protection from predators and insects.",knowledgeFIREDescription02:"Expand human activity into the dark and colder hours of the night.",knowledgeFIREDescription03:"Be able to burn down forests for food, which can also start changing the environment.",knowledgeHULAName:"Hunting large animals",knowledgeHULAMessage:"Lions and sharks evolved to fill the position of top predator over millions of years.<br>But humans ascend to this position almost immediately so they are not well adapted to it.",knowledgeHULADescription01:"Take more risks in hunting larger animals for more food.",knowledgeHULADescription02:"The extinction of large animals, which is very likely to happen because of their long pregnancy, can completely change the ecological system.",knowledgeNOMAName:"Living a nomadic lifestyle",knowledgeNOMAMessage:"They are roaming around in a large area to reach new food resources.<br>Nomadic hunting and gathering is the oldest human subsistence method.",knowledgeNOMADescription01:"Follow the annual migration of animals and the growth cycles of plants to obtain food.",knowledgeNOMADescription02:"Prevent infectious diseases to take hold and spread.",knowledgeCOOKName:"Cooking",knowledgeCOOKMessage:"After the domestication of fire, our ancestors start cooking food.<br>Cooking provides better diet to support their hunter-gatherer lifestyle.",knowledgeCOOKDescription01:"Start eating many new things that could not be digested earlier, such as wheat, rice and potatoes.",knowledgeCOOKDescription02:"Improve nutrition by cooked proteins.",knowledgeCOOKDescription03:"Kill germs and parasites that infest food.",knowledgeGOSSName:"Gossiping",knowledgeGOSSUnlock:"Without gossiping, it is very hard to cooperate effectively with other people.",knowledgeGOSSMessage:"The ability to gossip helps humans to form larger and more stable bands.<br>They are now gaining information without spending all day watching other people around.",knowledgeGOSSDescription01:"Exchange information about what other people are doing and thinking to help them understand each other and start living in larger bands.",knowledgeSPIRName:"Speaking about gods",knowledgeSPIRUnlock:"The stability of larger band is broken easily, people can not intimately know too many individuals.",knowledgeSPIRMessage:"The secret that enables humans to go beyond the threshold of 150 individuals is fictive language.<br>By believing in common gods, larger numbers of strangers can cooperate successfully.",knowledgeSPIRDescription01:"Unlike ants that know how to cooperate with large numbers of individuals based on their genetic code, humans don't really know how to create larger corporation effectively without basing it on imaginary stories that exist only in their minds.",knowledgeSPIRDescription02:"Suffer more from infectious diseases.",knowledgeOSEAName:"Crossing the open sea",knowledgeOSEAMessage:"Without any significant genetic evolution, humans can live in almost everywhere.<br>They soon make the biggest ecological disasters that ever befall the animal kingdom.",knowledgeOSEADescription01:"Develop sailing crafts and boats to cross large stretches of open sea and start living in new remote islands or Continent.",knowledgeOSEADescription02:"Humans are able to adapt almost over a night to a completely new ecosystem based on all knowledge they have gained.",knowledgeCOSOName:"Coming soon...",knowledgeCOSODescription01:"You have been watching the ancient world from the first appearance of our ancestors to <b>the cognitive revolution</b>.",knowledgeCOSODescription02:"During this time, humans gain some remarkable knowledge not only to spread all over the world but also to adapt to completely new ecological conditions within a very short time.",knowledgeCOSODescription03:"The next part of the game which is simulated <b>the agricultural revolution</b> will be released soon."}}}(window),function(a){"use strict";var b=a.WorldJS,c=b.Language;b.KnowledgeData={huga:{id:"huga",name:c.knowledgeHUGAName,message:c.knowledgeHUGAMessage,description:[{text:c.knowledgeHUGADescription01,code:["Adult +1 food / year","Food resource +10k"]}],iq:{priority:1,gained:0,required:500},following:["fire","hula"],affectedYear:0,onAffected:function(a){var b=a.statistic;a.rules.food.adult+=1,b.foodResource+=1e4,b.food<0&&(b.foodResource+=b.food,b.food=0),a.items.meat.enabled=!0,a.items.fruit.enabled=!0}},fire:{id:"fire",name:c.knowledgeFIREName,message:c.knowledgeFIREMessage,description:[{text:c.knowledgeFIREDescription01,code:["Death rate -10%"]},{text:c.knowledgeFIREDescription02,code:["Base IQ +1"]},{text:c.knowledgeFIREDescription03,code:["Food resource recovery -5% / century"]}],iq:{priority:.1,gained:0,required:3e3},following:["cook","noma"],affectedYear:0,onAffected:function(a){var b=a.rules;b.chanceIncr.death-=.1,b.baseIQ+=1,a.event.add("yearPassed","burningForests",function(){var a=this,b=a.statistic.year,c=a.knowledge.list.fire.affectedYear;b%100==c%100&&b>c&&(a.rules.food.resourceIncr-=.1)}),a.items.fire.enabled=!0}},hula:{id:"hula",name:c.knowledgeHULAName,message:c.knowledgeHULAMessage,description:[{text:c.knowledgeHULADescription01,code:["Death rate +10%","Adult +2 food / year","Food resource +5k"]},{text:c.knowledgeHULADescription02,code:["Food resource recovery -5% / century"]}],iq:{priority:.1,gained:0,required:2e4},following:[],affectedYear:0,onAffected:function(a){var b=a.rules,c=a.statistic;b.chanceIncr.death+=.1,b.food.adult+=2,c.foodResource+=5e3,c.food<0&&(c.foodResource+=c.food,c.food=0),a.event.add("yearPassed","largeAnimalsDisappearing",function(){var a=this,b=a.statistic.year,c=a.knowledge.list.hula.affectedYear;b%100==c%100&&b>c&&(a.rules.food.resourceIncr-=.1)})}},noma:{id:"noma",name:c.knowledgeNOMAName,message:c.knowledgeNOMAMessage,description:[{text:c.knowledgeNOMADescription01,code:["Enable food resource recovery"]},{text:c.knowledgeNOMADescription02,code:["Death rate -10%"]}],iq:{priority:.1,gained:0,required:5e4},following:["osea"],affectedYear:0,onAffected:function(a){a.event.add("yearPassed","foodResourceRecovering",function(){var a=this,b=a.statistic.year,c=a.knowledge.list.noma.affectedYear;if(b%10==c%10&&b>c){var d=a.rules,e=10*d.population.limit*d.food.adult;e=Math.max(0,e+Math.ceil(e*d.food.resourceIncr)),a.statistic.foodResource=e}}),a.rules.chanceIncr.death-=.1}},cook:{id:"cook",name:c.knowledgeCOOKName,message:c.knowledgeCOOKMessage,description:[{text:c.knowledgeCOOKDescription01,code:["Adult +1 food / year","Food resource +20k"]},{text:c.knowledgeCOOKDescription02,code:["Base IQ +1"]},{text:c.knowledgeCOOKDescription03,code:["Death rate -10%","Food spoilage -10%"]}],iq:{priority:.1,gained:0,required:5e3},following:[],affectedYear:0,onAffected:function(a){var b=a.rules,c=a.statistic;b.food.adult+=1,c.foodResource+=2e4,c.food<0&&(c.foodResource+=c.food,c.food=0),b.baseIQ+=1,b.chanceIncr.death-=.1,b.foodSpoilage.foodDecr-=.1,a.items.pot.enabled=!0}},goss:{id:"goss",name:c.knowledgeGOSSName,message:c.knowledgeGOSSMessage,description:[{text:c.knowledgeGOSSDescription01,code:["Population limit 150","Base IQ +1","Child -1 food / year"]}],iq:{priority:.1,gained:0,required:1e4},following:[],affectedYear:0,onAffected:function(a){var b=a.rules;b.population.limit=150,b.baseIQ+=1,b.food.child-=1,a.padding=10}},spir:{id:"spir",name:c.knowledgeSPIRName,message:c.knowledgeSPIRMessage,description:[{text:c.knowledgeSPIRDescription01,code:["Population limit 500","Base IQ +1","Child -1 food / year"]},{text:c.knowledgeSPIRDescription02,code:["Death rate +10%"]}],iq:{priority:.1,gained:0,required:5e4},following:[],affectedYear:0,onAffected:function(a){var b=a.rules;b.population.limit=500,b.baseIQ+=1,b.food.child-=1,b.chanceIncr.death+=.1}},osea:{id:"osea",name:c.knowledgeOSEAName,message:c.knowledgeOSEAMessage,description:[{text:c.knowledgeOSEADescription01,code:["Food resource +10k","Food resource recovery +20%"]},{text:c.knowledgeOSEADescription02,code:["Death rate +0%"]}],iq:{priority:.1,gained:0,required:2e5},following:[],affectedYear:0,onAffected:function(a){var b=a.statistic;b.foodResource+=1e4,b.food<0&&(b.foodResource+=b.food,b.food=0),a.rules.food.resourceIncr+=.2}},coso:{id:"coso",name:c.knowledgeCOSOName,description:[{text:c.knowledgeCOSODescription01,code:[]},{text:c.knowledgeCOSODescription02,code:[]},{text:c.knowledgeCOSODescription03,code:[]}],iq:{priority:.1,gained:0,required:1e9},following:[],affectedYear:0,onAffected:function(){}}}}(window),function(a,b){"use strict";var c,d=a.WorldJS;c=d.Guide=function(a){var c=this;c.world=a,c.$container=b,c.queue=[]},c.prototype.setContainer=function(a){this.$container=a},c.prototype.show=function(a,b){var c=this,d=c.world;if("undefined"!=typeof a)c.queue.push({message:a,ytl:b}),1==c.queue.length&&c.show();else if(c.queue.length>0){var e=c.queue[0],f=d.statistic.year+e.ytl;c.$container.html(e.message).animate({bottom:0},400),d.event.add("yearPassed","guide",function(){var a=this;a.statistic.year>=f&&(a.guide.hide(),a.event.remove("yearPassed","guide"))})}},c.prototype.hide=function(){var a=this,b=(a.world,a.$container);b.animate({bottom:-b.outerHeight()},400,"swing",function(){a.queue.shift(),a.show()})}}(window),function(a){"use strict";var b=a.$,c=a.WorldJS,d=c.Interface={},e={statistic:{year:0,population:0,men:0,women:0,boys:0,girls:0,families:0,food:0,foodResource:0,iq:0,maxIQ:0,yearMaxIQ:0,maxAge:0,yearMaxAge:0,avgIQ:0,avgAge:0,avgChildren:0},rules:{adultFoodChange:0,childFoodChange:0,foodResourceRecovery:100,foodSpoilage:0,deathChance:0},knowledge:{knowledgeTrending:0,knowledgeHistory:0},misc:{labelPopulationLimit:!1,labelNotEnoughResource:!1,labelFamine:!1}};for(var f in e)if(e.hasOwnProperty(f)){var g=e[f];for(var h in g)if(g.hasOwnProperty(h)){var i=g[h];g[h]={container:b("#world-"+h),value:i},-1!=b.inArray(h,["men","women","families","boys","girls"])&&(g[h+"-ex"]={container:b("#world-"+h+"-ex"),value:i})}}e.set=function(a,b){b!=a.value&&(a.value=b,a.container.html(b))},e.toggleLabel=function(a,b){b!=a.value&&(a.value=b,b?a.container.removeClass("hide"):a.container.addClass("hide"))},d.knowledgePriorityHTML=function(a,b){b=b||!1;for(var c=[{name:"low",value:.1},{name:"normal",value:1},{name:"high",value:2}],d=['<span class="no-wrap">'],e=0;e<c.length;e++){var f=c[e],g=a.iq.priority===f.value?"checked ":"",h=b?"priority-radio-clone":"priority-radio",i=a.id+"-"+f.name,j=b?a.id+"-clone":a.id;d.push(['<label class="radio-inline">','<input type="radio" '+g,'class="'+h+" "+i+'" ','value="'+f.name+'" ','name="'+j+'">',f.name,"</label>"].join(""))}return d.push("</span>"),d.join("")},d.knowledgeDescriptionHTML=function(a){for(var b=a.description,c=[],d=0;d<b.length;d++){var e=b[d];c.push("<p>&bull; "+e.text),e.code.length>0&&c.push(" <code>"+e.code.join("</code> <code>")+"</code>"),c.push("</p>")}return c.join("")},d.trendingAdded=function(a){var c;switch(a.iq.priority){case.1:c="progress-bar progress-bar-danger";break;case 2:c="progress-bar";break;default:c="progress-bar progress-bar-info"}var f=e.knowledge,g=f.knowledgeTrending.container,h=" collapsed",i=" collapse";0===g.find(".knowledge-detail").filter(".in,.collapsing").length&&(h="",i=" in");var j="world-knowledge-"+a.id,k=['<div class="knowledge panel">','<a class="knowledge-name'+h+'" href="#'+j+'" ','data-parent="#world-knowledgeTrending" data-toggle="collapse">',a.name,'<span class="caret"></span>',"</a>",'<div class="knowledge-progress progress">','<div class="'+c+'"></div>',"</div>",'<div class="knowledge-detail panel-collapse'+i+'" id="'+j+'">','<div class="knowledge-iq">',"&bull; Require: ",'<span class="no-wrap">','<span class="knowledge-progress-iq">0</span> / ',a.iq.required+" IQ","</span>","</div>",'<div class="knowledge-priority">',"&bull; Priority: ",d.knowledgePriorityHTML(a),"</div>",'<div class="knowledge-description">',d.knowledgeDescriptionHTML(a),"</div>","</div>","</div>"].join("");g.append(k);var l=b("#"+j);f[a.id]={container:l,IQContainer:l.find(".knowledge-progress-iq"),barContainer:l.siblings(".knowledge-progress").find(".progress-bar")}},d.trendingRemoved=function(a){var b=e,c=b.knowledge[a.id];c.IQContainer.html(a.iq.required),c.barContainer.width("100%"),c.container.closest(".knowledge").remove(),delete b.knowledge[a.id];var f=['<div class="knowledge">','<div class="knowledge-name">',b.statistic.year.value+1+": "+a.name,"</div>",'<div class="knowledge-detail">','<div class="knowledge-description">',d.knowledgeDescriptionHTML(a),"</div>","</div>","</div>"].join("");b.knowledge.knowledgeHistory.container.prepend(f)},d.yearPassed=function(){var a=this,c=e,d=a.statistic,f=c.statistic;for(var g in f)if(f.hasOwnProperty(g))switch(g){case"avgIQ":var h=0===d.population?0:Math.round(d.iq/d.population);c.set(f.avgIQ,h);break;case"avgAge":var i=0===d.die?0:Math.round(d.sumAge/d.die);c.set(f.avgAge,i);break;default:c.set(f[g],d[g]),-1!=b.inArray(g,["men","women","families","boys","girls"])&&c.set(f[g+"-ex"],d[g])}var j=a.rules,k=c.rules;c.set(k.deathChance,(100*j.chance.death).toFixed()),c.set(k.adultFoodChange,j.food.adult),c.set(k.childFoodChange,j.food.child),c.set(k.foodSpoilage,(100*j.foodSpoilage.foodDecr).toFixed()),c.set(k.foodResourceRecovery,(100+100*j.food.resourceIncr).toFixed());for(var l=a.knowledge,m=0,n=l.trending.length;n>m;m++){var o=l.list[l.trending[m]],p=c.knowledge[o.id];p.IQContainer.html(o.iq.gained),p.barContainer.width(Math.round(o.iq.gained/o.iq.required*100)+"%")}var q=c.misc;c.toggleLabel(q.labelPopulationLimit,d.population>=j.population.limit),c.toggleLabel(q.labelNotEnoughResource,d.foodResource<75),c.toggleLabel(q.labelFamine,d.food<=j.famine.unit)},b(".js-statistic-toggle").each(function(){b(this).click(function(){var a=b("#world-statistic-container");a.is(":visible")?a.addClass("visible-lg"):a.removeClass("visible-lg")
})});var j=c.Language;b("#world-intro .item").each(function(a){var c=b(this);switch(a){case 0:c.find("blockquote").html(j.introPhysicsQuote+"<small>"+j.introPhysicsAuthor+"</small>"),c.find("p:first").html(j.introPhysics01.replace("Big Bang",'<span class="label label-danger">Big Bang</span>')),c.find("p:last").html(j.introPhysics02.replace("Physics",'<span class="label label-info">Physics</span>'));break;case 1:c.find("blockquote").html(j.introChemistryQuote+"<small>"+j.introChemistryAuthor+"</small>"),c.find("p:first").html(j.introChemistry01),c.find("p:last").html(j.introChemistry02.replace("Chemistry",'<span class="label label-info">Chemistry</span>'));break;case 2:c.find("blockquote").html(j.introBiologyQuote+"<small>"+j.introBiologyAuthor+"</small>"),c.find("p:first").html(j.introBiology01),c.find("p:last").html(j.introBiology02.replace("Biology",'<span class="label label-info">Biology</span>'));break;case 3:c.find("blockquote").html(j.introHistoryQuote+"<small>"+j.introHistoryAuthor+"</small>"),c.find("p:first").html(j.introHistory01.replace("Homo sapiens",'<span class="label label-danger">Homo sapiens</span>')),c.find("p:last").html(j.introHistory02.replace("History",'<span class="label label-info">History</span>'));break;case 4:c.find("p:first").html(j.introGame01.replace("World JS",'<span class="label label-danger">World JS</span>')),c.find("p:first").next().html(j.introGame02.replace("the cognitive revolution",'<span class="label label-info">the cognitive revolution</span>')),c.find("p:last").html(j.introGame03.replace("anvo4888@gmail.com",'<a href="mailto: anvo4888@gmail.com">anvo4888@gmail.com</a>'))}}),b("#world-intro").removeClass("hide").on("slid.bs.carousel",function(){var a=b(this),c=a.find(".content"),d=a.find(".prev"),e=a.find(".next");c.find(".item:first").hasClass("active")?d.addClass("disabled"):d.removeClass("disabled"),c.find(".item:last").hasClass("active")?(e.addClass("disabled"),b(".opacity").animate({opacity:1},"fast")):e.removeClass("disabled")})}(window),function(a){"use strict";var b=a.document,c=a.$,d=a.WorldJS,e=d.Interface,f=d.Language,g=new d,h=g.event,i=(g.statistic=new d.Statistic(g),g.rules=new d.Rules(g)),j=g.knowledge=new d.Knowledge(g),k=g.guide=new d.Guide(g),l=g.story={knowledge:{addList:function(a){j.list=a},addTrending:function(a){j.trending=[a.id],e.trendingAdded(a)}},ui:{bindKnowledge:function(){j.trendingAdded=e.trendingAdded,j.trendingRemoved=function(a){e.trendingRemoved(a);var b=["<div><b>✓ "+a.name+"</b></div>","<div>"+a.message+"</div>"];if(a.following.length>0){b.push("<hr>"),b.push('<div class="knowledge-trending">');for(var d=0;d<a.following.length;d++){var f=j.list[a.following[d]];b.push(['<div class="knowledge-clone">',"<div><b>"+f.name+"</b></div>",'<div class="knowledge-priority">',"&bull; Priority: ",e.knowledgePriorityHTML(f,!0),"</div>","</div>"].join(""))}b.push("</div>")}switch(k.show(b.join(""),15),a.id){case"noma":c("#world-foodResourceRecovery").parent().removeClass("text-muted")}}},bindKnowledgePriorityRadio:function(){c(b).on("change",".priority-radio",function(){var a=c(this),b=a.attr("name"),d=a.val(),e=1,f="progress-bar progress-bar-info";switch(d){case"high":e=2,f="progress-bar";break;case"low":e=.1,f="progress-bar progress-bar-danger"}a.closest(".knowledge").find(".progress-bar").attr("class",f),c(".priority-radio-clone."+b+"-"+d).prop("checked",!0),g.knowledge.list[b].iq.priority=e}),c(b).on("change",".priority-radio-clone",function(){var a=c(this),b=a.attr("name").split("-").shift(),d=a.val();c(".priority-radio."+b+"-"+d).click()})},bindStartButton:function(){c("#world-start-btn").click(function(){c("#world-intro").addClass("hide"),c(".opacity").animate({opacity:1},"fast"),c("#world-pause-btn").prop("disabled",!1).click()}),c("#world-pause-btn").click(function(){g.running?(g.stop(),c(this).html("Play")):(g.start(),c(this).html("Pause"))})},bindDisplayButton:function(){c("#world-display-btns button").click(function(){var a=c(this),b=a.data("display");a.addClass("active").siblings(".active").removeClass("active"),g.displayMode=b})},bindSpeedButton:function(){c("#world-speed-btns button").click(function(){var a=c(this),b=a.data("speed");switch(a.addClass("active").siblings(".active").removeClass("active"),b){case 2:case 5:g.tickPerYear=60/b,g.speed=b;break;default:g.tickPerYear=60,g.speed=1}})}},event:{populationControl:function(){h.add("yearPassed","populationControl",function(){var a=this,b=a.statistic.year;if(30>=b)20==b&&a.addSeeds(30,{minAge:10,maxAge:30,fromBorder:"random",types:[a.Male,a.Female]});else{var c=a.statistic,d=a.rules;if(d.chance.childbirth=0,c.population<150&&c.food>d.famine.unit){var e=Math.min(150,d.population.limit)-c.population;e>0&&(d.chance.childbirth=Math.ceil(e/10))}b>1e3&&a.event.remove("yearPassed","populationControl")}})},populationLimitUnlock:function(){h.add("yearPassed","populationLimitUnlock",function(){var a=this,b=a.knowledge;if(!(b.completed.length<1))for(var c=[{id:"goss",population:50,message:f.knowledgeGOSSUnlock},{id:"spir",population:150,message:f.knowledgeSPIRUnlock}],d=0;d<c.length;d++){var g=c[d].id,h=b.list[g];if(a.statistic.population>=c[d].population&&!h.added){h.added=!0,b.trending.push(g),e.trendingAdded(h),a.guide.show(['<div class="knowledge-trending">','<div class="knowledge-clone">',"<div><b>"+h.name+"</b></div>",'<div class="knowledge-priority">',"&bull; Priority: ",e.knowledgePriorityHTML(h,!0),"</div>","</div>","</div>","<div>"+c[d].message+"</div>"].join(""),15),"spir"==g&&a.event.remove("yearPassed","populationLimitUnlock");break}}})},yearPassed:function(){h.add("yearPassed","default",function(){var a=this,b=a.knowledge,d=a.statistic;if(8==b.completed.length&&0===b.trending.length){var g="coso";b.trending.push(g),e.trendingAdded(b.list[g])}500==d.year&&a.guide.show(f.storyEnd01,250),0===d.population&&(c("#world-pause-btn").prop("disabled","disabled"),a.stop(),a.guide.show(f.storyEnd02,1e3))})}},guide:{setup:function(){k.setContainer(c("#world-container .guide"));for(var a=[{year:5,ytl:15,html:f.storyBegin01},{year:20,ytl:15,html:f.storyBegin02}],b=0;b<a.length;b++)!function(a){h.add("yearPassed","message-"+a.year,function(){var b=this;b.statistic.year==a.year&&(b.guide.show(a.html,a.ytl),b.event.remove("yearPassed","message-"+a.year))})}(a[b])}},world:{addFirstMen:function(){var a=30;g.addSeed(g.Male,{x:10,y:10,moveTo:{x:320,y:180},age:13,moveUntilStep:9999,chances:{death:[{range:[1,a],from:0,to:0},{range:[a,60],from:.01,to:.02},{range:[60,80],from:.02,to:.05},{range:[80,100],from:.05,to:.5}],marriage:[{range:[1,a],from:1,to:1}]}}),g.addSeed(g.Female,{x:630,y:350,moveTo:{x:320,y:180},age:13,moveUntilStep:9999,chances:{death:[{range:[1,a],from:0,to:0},{range:[a,65],from:.01,to:.02},{range:[65,85],from:.02,to:.05},{range:[85,105],from:.05,to:.5}],childbirth:[{range:[1,a],from:1,to:1}]}})},addItems:function(){g.items={meat:{enabled:!1,who:"man",when:"moving",icon:{x:37,y:0,dx:5,dy:8,width:11,height:10}},fruit:{enabled:!1,who:"woman",when:"moving",icon:{x:37,y:10,dx:5,dy:8,width:11,height:10}},fire:{enabled:!1,who:"man",when:"standing",icon:{x:48,y:0,dx:12,dy:12,width:11,height:10}},pot:{enabled:!1,who:"wife",when:"standing",icon:{x:48,y:10,dx:-2,dy:12,width:11,height:10}}}}}};h.add("yearPassed","updateUI",e.yearPassed),l.event.populationControl(),l.event.populationLimitUnlock(),l.event.yearPassed(),i.population.limit=50,l.knowledge.addList(d.KnowledgeData),l.knowledge.addTrending(j.list.huga),l.ui.bindKnowledge(),l.ui.bindKnowledgePriorityRadio(),l.guide.setup(),l.ui.bindStartButton(),l.ui.bindDisplayButton(),l.ui.bindSpeedButton(),g.init("world"),g.padding=50,l.world.addFirstMen(),l.world.addItems()}(window);