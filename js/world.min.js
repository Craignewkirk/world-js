/*!
 * World JS: Evolution Simulator
 * https://github.com/anvoz/world-js
 *
 * Version 1.3
 *
 * Copyright (c) 2013 An Vo - anvo4888@gmail.com
 * Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
 */

!function(a){"use strict";var c=a.document,d=function(){return a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(b){a.setTimeout(function(){b(+new Date)},1e3/60)}}(),e=a.WorldJS=function(){var a=this;a.running=!1,a.stopCallback=function(){},a.width=640,a.height=360,a.padding=10,a.canvas={wrapper:!1,context:!1},a.sprite={src:"images/seeds.png",image:!1},a.nextSeedId=1,a.maxSafeSeedsForDisplay=3e4,a.tickPerYear=60,a.tickMod=0,a.distributedTicks=[];for(var b=0;b<a.tickPerYear-1;b++)a.distributedTicks.push(0);a.lastTickTime=0,a.fps=0,a.Tile=new e.Tile,a.Knowledge=new e.Knowledge,a.Statistic=new e.Statistic,a.Rules=new e.Rules,a.yearPassedCallback=function(){}};e.prototype.init=function(a){var b=this,d=c.createElement("canvas"),e=b.canvas.wrapper=c.getElementById(a),f=b.width=d.width=e.clientWidth||b.width,g=b.height=d.height=e.clientHeight||b.height;e.appendChild(d),b.canvas.context=d.getContext("2d");var h=new Image;return h.src=b.sprite.src,b.sprite.image=h,b.Tile.init(b,f,g),b},e.prototype.add=function(a,b){var c=this,d=new a(b);d.world=c,d.id=c.nextSeedId++,d.age=b.age||0,d.age>0&&(d.tickCount=d.age*c.tickPerYear),d.tickMod=c.tickMod,d.IQ+=c.Rules.baseIQ;var e=function(a,b){return Math.floor(Math.random()*(b-a+1)+a)};d.x===!1&&(d.x=e(0,c.width-1-Math.max(d.appearance.width,c.padding))),d.y===!1&&(d.y=e(0,c.height-1-d.appearance.height-c.padding)),d.tileIndex=c.Tile.getIndex(d),c.Tile.set(d);for(var f=c.distributedTicks,g=0,h=f[g],i=0,j=f.length;j>i;i++)f[i]<h&&(g=i,h=f[i]);return f[g]++,d.tickIndex=g,d.tickCount+=(c.tickMod+d.tickCount+g)%d.actionInterval,d.stepCount=d.tickCount,c.Statistic.seedAdded(d),c},e.prototype.remove=function(a){var b=this;return b.Statistic.seedRemoved(a),a.married&&(a.married=!1,a.relationSeed.married=!1,a.relationSeed.relationSeed=!1,a.relationSeed=!1),b.Tile.rem(a),b.distributedTicks[a.tickIndex]--,b},e.prototype.addRandomPeople=function(a,b,c,d){var e=this,f=e.tickPerYear,g=function(a,b){return Math.floor(Math.random()*(b-a+1)+a)};b="undefined"==typeof b?15:b,c="undefined"==typeof c?20:c,d="undefined"==typeof d?0:d;for(var h=0;a>h;h++){var i=g(b,c),j={age:i,tickCount:i*f};if(d>0){var k=5==d?g(1,4):d;switch(k){case 1:j.y=0;break;case 2:j.y=e.height-1;break;case 3:j.x=0;break;case 4:j.x=e.width-1}}a/2>h?e.add(e.Male,j):e.add(e.Female,j)}return e},e.prototype.run=function(a){var b=this,c=b.Statistic,e=b.canvas.context,f=b.sprite.image;b.tickMod=++b.tickMod%b.tickPerYear;var g=0===b.tickMod,h=c.population<=b.maxSafeSeedsForDisplay||g;h&&e.clearRect(0,0,b.width,b.height);for(var i=b.Tile.list,j=b.Tile.maxDisplayedSeeds,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=i.length;s>r;r++)for(var t=i[r],u=0,v=0,w=t.length;w>v;v++)if(t[v]){var x=t[v],y=x.tileIndex;if(x.tickMod==b.tickMod)continue;x.tickMod=b.tickMod,g&&(x.age++,k++,l+=x.IQ,x instanceof b.Male?x.age<=x.maxChildAge?o++:(m++,x.married&&q++):x.age<=x.maxChildAge?p++:n++),h&&j>u&&(x.draw(e,f),u++),x.tick();var z=b.Tile.getIndex(x);z!==y&&(b.Tile.rem(x),x.tileIndex=z,b.Tile.set(x))}return g&&(c.yearPassed({population:k,IQ:l,men:m,women:n,boys:o,girls:p,families:q}),b.Rules.change(b),b.Knowledge.gain(b),setTimeout(function(){b.yearPassedCallback.call(b)},1),0===k)?(b.running=!1,void 0):(b.running?(b.fps=1e3/(a-b.lastTickTime),b.lastTickTime=a,d(b.run.bind(b))):(b.stopCallback.call(b),b.stopCallback=function(){}),b)},e.prototype.start=function(){this.running=!0,this.run()},e.prototype.stop=function(a){this.running=!1,"function"==typeof a&&(this.stopCallback=a)}}(window),function(a){"use strict";var d,c=a.WorldJS;d=c.Tile=function(){var a=this;a.list=[],a.availableArrayIndexes=[],a.size=20,a.maxDisplayedSeeds=7,a.totalTiles=!1,a.tilesPerRow=!1,a.tilesPerCol=!1},d.prototype.init=function(a,b,c){var d=a.Tile,e=d.size,f=Math.ceil(b/e)*Math.ceil(c/e);d.totalTiles=f,d.tilesPerRow=Math.ceil(b/e),d.tilesPerCol=Math.ceil(c/e);for(var g=d.list,h=d.availableArrayIndexes,i=0;f>i;i++)g.push([]),h.push([])},d.prototype.getIndex=function(a){return Math.floor(a.x/this.size)+Math.floor(a.y/this.size)*this.tilesPerRow},d.prototype.set=function(a){var b=this,c=b.list[a.tileIndex],d=b.availableArrayIndexes[a.tileIndex];d.length>0?(a.tileArrayIndex=d.pop(),c[a.tileArrayIndex]=a):(a.tileArrayIndex=c.length,c.push(a))},d.prototype.rem=function(a){var b=this;b.list[a.tileIndex][a.tileArrayIndex]=!1,b.availableArrayIndexes[a.tileIndex].push(a.tileArrayIndex)}}(window),function(a){"use strict";var d,c=a.WorldJS;d=c.Knowledge=function(){var a=this;a.list={},a.trending=[],a.trendingAdded=function(){},a.trendingRemoved=function(){},a.completed=[]},d.prototype.gain=function(a){for(var b=this,c=a.Statistic.year,d=a.Statistic.IQ,e=[],f=0,g=0,h=b.trending.length;h>=g;g++){if(e[g]=Math.floor(101*Math.random()),h>g){var i=b.list[b.trending[g]];1!=i.IQ.priority&&(e[g]*=i.IQ.priority)}f+=e[g]}for(var j=[],k=[],l=[],g=0,h=b.trending.length;h>g;g++){var i=b.list[b.trending[g]],m=d*e[g]/f,n=Math.floor(i.IQ.gained+m);n>=i.IQ.required?(i.IQ.gained=i.IQ.required,k.push.apply(k,i.following),i.affectedYear=c,i.onAffected(a),l.push(i)):(i.IQ.gained=n,j.push(i.id))}if(l.length>0){for(var g=0;g<l.length;g++)b.trendingRemoved(l[g]),b.completed.push(l[g]);for(var g=0;g<k.length;g++)b.trendingAdded(b.list[k[g]]),j.push(k[g]);b.trending=j}}}(window),function(a){"use strict";var d,c=a.WorldJS;d=c.Statistic=function(){var a=this;a.year=0,a.food=0,a.population=0,a.IQ=0,a.men=0,a.women=0,a.boys=0,a.girls=0,a.families=0,a.maxIQ=0,a.yearMaxIQ=0,a.maxAge=0,a.yearMaxAge=0,a.die=0,a.sumAge=0,a.dieMarriedFemale=0,a.sumChildren=0},d.prototype.seedAdded=function(a){var b=this;a.IQ>b.maxIQ&&(b.maxIQ=a.IQ,b.yearMaxIQ=b.year)},d.prototype.seedRemoved=function(a){var b=this;b.die++;var c=a.age;c>b.maxAge&&(b.maxAge=c,b.yearMaxAge=b.year),b.sumAge+=c,"undefined"!=typeof a.totalChildren&&(b.dieMarriedFemale++,b.sumChildren+=a.totalChildren)},d.prototype.yearPassed=function(a){var b=this;b.year++,b.population=a.population,b.IQ=a.IQ,b.men=a.men,b.women=a.women,b.boys=a.boys,b.girls=a.girls,b.families=a.families}}(window),function(a){"use strict";var d,c=a.WorldJS;d=c.Rules=function(){var a=this;a.baseIQ=0,a.Chance={death:0,marriage:0,childbirth:0},a.ChanceIncr={death:0,marriage:0,childbirth:0},a.Food={adult:1,child:-1,min:-1e4},a.Famine={deathChanceIncr:.5,unit:-1e3},a.FoodSpoilage={foodDecr:.9,interval:1}},d.prototype.change=function(a){var b=a.Rules,c=a.Statistic,d=c.food,e=c.men+c.women,f=c.boys+c.girls;d+=e*b.Food.adult+f*b.Food.child,d<b.Food.min&&(d=b.Food.min);var g=0;if(d<=b.Famine.unit){var h=Math.floor(d/b.Famine.unit);g+=h*b.Famine.deathChanceIncr}0===c.year%b.FoodSpoilage.interval&&d>0&&(d-=Math.floor(d*b.FoodSpoilage.foodDecr)),c.food=d,b.Chance.death=g+b.ChanceIncr.death}}(window),function(a){"use strict";var d,c=a.WorldJS;d=c.prototype.Seed=function(a){var b=this;b.world=!1,b.id=!1,b.tileIndex=!1,b.tickIndex=!1,b.tickMod=!1,b.age=a.age||0,b.x="undefined"==typeof a.x?!1:a.x,b.y="undefined"==typeof a.y?!1:a.y,b.appearance=a.appearance||!1,b.relationSeed=a.relationSeed||!1,b.tickCount=a.tickCount||0,b.actionInterval=a.actionInterval||30,b.stepCount=b.tickCount,b.jumpInterval=20,b.moveUntilStep=a.moveUntilStep||b.tickCount+Math.floor(21*Math.random()+10)*b.jumpInterval,b.ageToMoveAgain=0,b.moveTo=a.moveTo||!1},d.prototype.draw=function(a,b){var c=this;if(c.appearance===!1)a.fillRect(c.x,c.y,10,10);else{var d=c.age<=c.maxChildAge?c.appearance.child:c.appearance,e=c.jumpInterval,f=10,g=c.stepCount%e,h=f>g?g+1:f-g%f-1;a.drawImage(b,d.x,d.y,d.width,d.height,c.x,c.y-h,d.width,d.height)}},d.prototype.move=function(a){var b=this,c=function(a,b){return Math.floor(Math.random()*(b-a+1)+a)};if(a)a.call(b);else{if(b.stepCount==b.moveUntilStep){if(0==b.ageToMoveAgain||b.ageToMoveAgain>b.age)return 0==b.ageToMoveAgain&&(b.ageToMoveAgain=b.age+c(2,10)),void 0;b.ageToMoveAgain=0,b.moveUntilStep=b.stepCount+c(10,50)*b.jumpInterval}if(b.moveTo===!1||b.moveTo.x===b.x&&b.moveTo.y===b.y){var d=b.world;b.moveTo={x:c(0,d.width-1-Math.max(b.appearance.width,d.padding)),y:c(d.padding,d.height-1-b.appearance.height-d.padding)}}}b.stepCount++,b.x<b.moveTo.x?b.x++:b.x>b.moveTo.x&&b.x--,b.y<b.moveTo.y?b.y++:b.y>b.moveTo.y&&b.y--},d.prototype.seek=function(a){var b=this,c=b.world.Tile,d=[[0,0],[-1,0],[1,0],[0,-1],[0,1],[-1,-1],[-1,1],[1,-1],[1,1]];a||(a=function(a){return a.id!=b.id});for(var e=c.tilesPerRow,f=c.tilesPerCol,g=0,h=d.length;h>g;g++){var i;if(0===g)i=b.tileIndex;else{var j=b.tileIndex%e+d[g][0],k=Math.floor(b.tileIndex/e)+d[g][1];if(!(j>=0&&e>j&&k>=0&&f>k))continue;i=j+k*e}for(var l=c.list[i],m=0,n=l.length;n>m;m++)if(l[m]&&b.id!=l[m].id){var o=l[m];if(a.call(b,o))return o}}return!1},d.prototype.tick=function(){var a=this;a.tickCount++,a.move()},d.prototype.getChance=function(a,b){for(var c=a.world,d=a.chances[b],e=a.age,f=0,g=0,h=0,i=0;d[f]&&e>d[f].range[0];){var j=d[f];g=j.range[0],h=j.from,i=(j.to-j.from)/(j.range[1]-j.range[0]),f++}var k=h+(e-g)*i;return 0!=c.Rules.Chance[b]&&(k+=k*c.Rules.Chance[b]),k}}(window),function(a){"use strict";var e,c=a.WorldJS,d=c.prototype.Seed;e=c.prototype.Male=function(a){var b=this;a.appearance={x:0,y:0,width:13,height:20,child:{x:26,y:0,width:11,height:10}},d.call(b,a),b.IQ=(a.IQ||0)+Math.floor(4*Math.random()),b.maxChildAge=15,b.married=!1,b.chances=a.chances||{death:[{range:[1,20],from:.02,to:.01},{range:[20,60],from:.01,to:.02},{range:[60,80],from:.02,to:.05},{range:[80,100],from:.05,to:.5}],marriage:[{range:[15,30],from:.1,to:.5},{range:[30,50],from:.5,to:.1},{range:[50,80],from:.1,to:.01}]}},e.prototype=Object.create(d.prototype),e.prototype.contructor=e,e.prototype.tick=function(){var a=this;a.tickCount++;var b=a.actionInterval;if(a.tickCount%b===b-1){var c=a.world,d=a.getChance(a,"death");if(d>0&&Math.random()<d)return c.remove(a),void 0;if(!a.married&&a.age>=a.chances.marriage[0].range[0]){var e=a.getChance(a,"marriage");if(e>0){var f=Math.random();if(e>f){var g=a.seek(function(b){return b instanceof c.Female&&!b.married&&b.age>=b.chances.childbirth[0].range[0]&&(b.age<=a.age||f*Math.ceil((b.age-a.age)/10)<e)});g!==!1&&(a.married=!0,g.married=!0,a.relationSeed=g,g.relationSeed=a,"undefined"==typeof g.totalChildren&&(g.totalChildren=0),g.ageLastBear=g.age+1)}}}}if(a.married){if(a.x===Math.max(0,a.relationSeed.x-10)&&a.y===a.relationSeed.y)return;a.move(function(){var a=this,b=a.relationSeed;a.moveTo.x=Math.max(0,b.x-10),a.moveTo.y=b.y})}else a.move(!1)}}(window),function(a,b){"use strict";var e,c=a.WorldJS,d=c.prototype.Seed;e=c.prototype.Female=function(a){var c=this;a.appearance={x:13,y:0,width:13,height:20,child:{x:26,y:10,width:11,height:10}},d.call(c,a),c.IQ=(a.IQ||0)+Math.floor(4*Math.random()),c.maxChildAge=15,c.married=!1,c.totalChildren=b,c.ageLastBear=0,c.chances=a.chances||{death:[{range:[1,25],from:.02,to:.01},{range:[25,65],from:.01,to:.02},{range:[65,85],from:.02,to:.05},{range:[85,105],from:.05,to:.5}],childbirth:[{range:[15,25],from:.1,to:.25},{range:[25,50],from:.25,to:.1},{range:[50,70],from:.1,to:.001}]}},e.prototype=Object.create(d.prototype),e.prototype.contructor=e,e.prototype.tick=function(){var a=this;a.tickCount++;var b=a.actionInterval;if(a.tickCount%b===b-1){var c=a.world,d=a.age,e=a.getChance(a,"death");if(e>0&&Math.random()<e)return c.remove(a),void 0;if(a.married&&d>=a.chances.childbirth[0].range[0]&&d>a.ageLastBear){var f=a.getChance(a,"childbirth");if(f>0&&Math.random()<f){a.ageLastBear=d+1,a.totalChildren++;var g={x:a.x,y:Math.min(c.height-1-c.padding,a.y+Math.floor(a.appearance.height/2)),IQ:Math.round((a.relationSeed.IQ+a.IQ)/2)};Math.random()<.5?c.add(c.Male,g):c.add(c.Female,g)}}}a.move(!1)}}(window),function(a){"use strict";var c=a.WorldJS;c.KnowledgeData={huga:{id:"huga",name:"Hunting and Gathering",description:["Living from edible plants and animals from the wild.","<ul><li>Adult +1 food / year</li></ul>"].join(""),IQ:{priority:1,gained:0,required:2e3},following:["crop","cabr"],affectedYear:!1,onAffected:function(a){a.Rules.Food.adult+=1}},crop:{id:"crop",name:"Plant crops",description:["Start agriculture by planting a few crops.","<ul><li>Adult +1 food / year</li></ul>"].join(""),IQ:{priority:1,gained:0,required:4e3},following:["agri"],affectedYear:!1,onAffected:function(a){a.Rules.Food.adult+=1}},cabr:{id:"cabr",name:"Cattle-breeding",description:["Domesticating animals to reduce the need of hunting wild animals for food.","<ul><li>Adult +1 food / year</li><li>Death rate -10%</li></ul>"].join(""),IQ:{priority:1,gained:0,required:6e3},following:[],affectedYear:!1,onAffected:function(a){a.Rules.Food.adult+=1,a.Rules.ChanceIncr.death-=.1}},agri:{id:"agri",name:"Agriculture",description:["Developing techniques to produce a large amount of food.","<ul><li>Adult +2 food / year</li><li>Food spoilage -20%</li></ul>"].join(""),IQ:{priority:1,gained:0,required:1e4},following:[],affectedYear:!1,onAffected:function(a){a.Rules.Food.adult+=2,a.Rules.FoodSpoilage.foodDecr-=.2}},fire:{id:"fire",name:"Control of fire",description:["Using fire for warmth and cooking.","<ul><li>Death rate -10%</li></ul>"].join(""),IQ:{priority:1,gained:0,required:4e3},following:["writ"],affectedYear:!1,onAffected:function(a){a.Rules.ChanceIncr.death-=.1}},writ:{id:"writ",name:"Writing",description:["Inventing symbols that stood for things.","<ul><li>Base IQ +1</li><li>Child -1 food per year</li></ul>"].join(""),IQ:{priority:1,gained:0,required:5e4},following:["coso"],affectedYear:!1,onAffected:function(a){a.Rules.baseIQ+=1,a.Rules.Food.child-=1}},coso:{id:"coso",name:"Coming soon...",description:['<span class="label label-danger">tl;dr</span> In the next update you will have the ability to expand the population beyond 7 billion and manage their knowledge to choose the fate of the world.<hr />',"Without any knowledge to be gained, the world will meet its apocalypse. Thus evolutions are needed in order for the world to progress and maintain its stability.<br /><br />","This is the idea behind <b>World JS: Evolution Simulator</b>. ","Hope you could understand its idea so far and contribute for its growth.<br /><br />","There are 10 types of people who can contribute to this open source project:<br />","<ul>",'<li>For those who understand binary: <a target="_blank" href="https://github.com/anvoz/world-js">Fork me on Github</a>.</li>','<li>For those who don\'t: Make your own knowledge list. See example in <a href="#" onclick="$(\'#knowledge a[rel=history]\').click(); return false;">knowledge history</a>.</li>',"</ul>",'For any feedback or ideas, email me at <a href="mailto: anvo4888@gmail.com">anvo4888@gmail.com</a>'].join(""),IQ:{priority:1,gained:0,required:2147483647},following:[],affectedYear:!1,onAffected:function(){}}}}(window),function(a){"use strict";var f,c=a.$,d=a.WorldJS,e="#world-freeze-btn";d.God={setWorldInstance:function(a){f=a},freeze:function(){var a=c(e);return f.running?(f.stop(),a.html("Unfreeze")):(f.start(),a.html("Freeze")),!1},setKnowledgePriority:function(a,b,d){f.Knowledge.list[b].IQ.priority=d;var e;return e=d>1?"progress-bar":1>d?"progress-bar progress-bar-danger":"progress-bar progress-bar-info",c(a).addClass("active").siblings().removeClass("active").parents(".knowledge").find(".progress").find(".progress-bar").attr("class",e),!1},addRandomPeople:function(a){var b=0==f.Statistic.population;return f.addRandomPeople(a),(b||!f.running)&&(f.start(),c(e).html("Freeze")),!1},kill:function(a){return f.running||f.start(),f.stop(function(){for(var b=f.Tile.list,d=Math.random,g=a/100,h=0,i=b.length;i>h;h++)for(var j=b[h],k=0,l=j.length;l>k;k++){var m=j[k];m&&d()<g&&f.remove(m)}f.start(),c(e).html("Freeze")}),!1},giveFood:function(a){return f.Statistic.food+=a,!1}}}(window),function(a){"use strict";var c=a.$,d=a.WorldJS,e=d.Interface={},f={Statistic:{year:0,population:0,food:0,men:0,women:0,families:0,boys:0,girls:0,IQ:0,maxIQ:0,yearMaxIQ:0,maxAge:0,yearMaxAge:0,avgIQ:0,avgAge:0,avgChildren:0},Rules:{adultFoodChange:0,childFoodChange:0,foodSpoilage:0},Knowledge:{knowledgeTrending:0,knowledgeHistory:0},Misc:{labelFamine:!1}};for(var g in f)if(f.hasOwnProperty(g)){var h=f[g];for(var i in h)if(h.hasOwnProperty(i)){var j=h[i];h[i]={container:c("#world-"+i),value:j},-1!=c.inArray(i,["men","women","families","boys","girls"])&&(h[i+"-ex"]={container:c("#world-"+i+"-ex"),value:j})}}f.set=function(a,b){b!=a.value&&(a.value=b,a.container.html(b))},e.trendingAdded=function(a){var b="world-knowledge-"+a.id,d=['<div id="world-knowledge-',a.id,'" class="knowledge">','<div class="name">',a.name,"</div>",'<div class="description">',a.description,"</div>",'<div class="progress"><div class="progress-bar progress-bar-info"></div></div>','<div class="clearfix">','<div class="btn-group priority">','<a class="btn btn-sm btn-default" href="#" title="Priority: low" onclick="return WorldJS.God.setKnowledgePriority(this, \'',a.id,"', 0.1);\">&bull;</a>",'<a class="btn btn-sm btn-default active" href="#" title="Priority: normal" onclick="return WorldJS.God.setKnowledgePriority(this, \'',a.id,"', 1);\">&gt;</a>",'<a class="btn btn-sm btn-default" href="#" title="Priority: high" onclick="return WorldJS.God.setKnowledgePriority(this, \'',a.id,"', 2);\">&gt;&gt;</a>","</div>",'<div class="IQ"><span class="progress-IQ">0</span> / ',a.IQ.required," IQ</div>","</div>","</div>"].join(""),e=f.Knowledge;e.knowledgeTrending.container.append(d);var g=c("#"+b);e[a.id]={container:g,IQContainer:g.find(".progress-IQ"),barContainer:g.find(".progress-bar")}},e.trendingRemoved=function(a){var b=f.Knowledge[a.id];b.IQContainer.html(a.IQ.required),b.barContainer.width("100%"),b.container.remove(),delete f.Knowledge[a.id];var c=['<div class="knowledge">','<div class="name">',f.Statistic.year.value,": ",a.name,"</div>",'<div class="description">',a.description,"</div>","</div>"].join("");f.Knowledge.knowledgeHistory.container.prepend(c)},e.yearPassed=function(){var a=this;25==a.Statistic.year&&a.addRandomPeople(50,10,20,5);var b=a.Statistic,d=f.Statistic;for(var e in d)if(d.hasOwnProperty(e))switch(e){case"avgIQ":var g=0==b.population?0:Math.round(b.IQ/b.population);f.set(d.avgIQ,g);break;case"avgAge":var h=0==b.die?0:Math.round(b.sumAge/b.die);f.set(d.avgAge,h);break;case"avgChildren":var i=0==b.dieMarriedFemale?0:Math.round(b.sumChildren/b.dieMarriedFemale);f.set(d.avgChildren,i);break;default:f.set(d[e],b[e]),-1!=c.inArray(e,["men","women","families","boys","girls"])&&f.set(d[e+"-ex"],b[e])}var j=a.Rules,k=f.Rules;f.set(k.adultFoodChange,j.Food.adult),f.set(k.childFoodChange,j.Food.child),f.set(k.foodSpoilage,100*j.FoodSpoilage.foodDecr);for(var l=a.Knowledge,m=0,n=l.trending.length;n>m;m++){var o=l.list[l.trending[m]],p=f.Knowledge[o.id];p.IQContainer.html(o.IQ.gained),p.barContainer.width(Math.round(100*(o.IQ.gained/o.IQ.required))+"%")}var q=f.Misc.labelFamine,r=b.food<=j.Famine.unit;r!=q.value&&(q.value=r,r?q.container.removeClass("hide"):q.container.addClass("hide"))},c("#knowledge .world-knowledge").each(function(){c(this).click(function(){return c(this).parent().addClass("active").siblings("li").removeClass("active"),"#world-knowledgeTrending"==c(this).attr("data-target")?(f.Knowledge.knowledgeTrending.container.removeClass("hide"),f.Knowledge.knowledgeHistory.container.addClass("hide")):(f.Knowledge.knowledgeTrending.container.addClass("hide"),f.Knowledge.knowledgeHistory.container.removeClass("hide")),!1})}),c(".js-navbar-toggle").each(function(){c(this).click(function(){var a=c(c(this).attr("data-target"));a.hasClass("in")?a.removeClass("in"):a.addClass("in")})}),c(".js-statistic-toggle").each(function(){c(this).click(function(){var a=c("#world-statistic-container");a.is(":visible")?a.addClass("visible-lg"):a.removeClass("visible-lg")})})}(window),function(a){"use strict";var c=a.WorldJS,d=c.Interface,e=new c,f=e.Knowledge;c.God.setWorldInstance(e),f.list=c.KnowledgeData,f.trending=["huga","fire"],d.trendingAdded(f.list.huga),d.trendingAdded(f.list.fire),f.trendingAdded=d.trendingAdded,f.trendingRemoved=d.trendingRemoved,e.yearPassedCallback=d.yearPassed,e.init("world");var g=30;e.add(e.Male,{x:10,y:10,moveTo:{x:320,y:180},age:13,moveUntilStep:9999,chances:{death:[{range:[1,g],from:0,to:0},{range:[g,60],from:.01,to:.02},{range:[60,80],from:.02,to:.05},{range:[80,100],from:.05,to:.5}],marriage:[{range:[1,g],from:1,to:1}]}}),e.add(e.Female,{x:630,y:350,moveTo:{x:320,y:180},age:13,moveUntilStep:9999,chances:{death:[{range:[1,g],from:0,to:0},{range:[g,65],from:.01,to:.02},{range:[65,85],from:.02,to:.05},{range:[85,105],from:.05,to:.5}],childbirth:[{range:[1,g],from:1,to:1}]}}),e.start()}(window);